"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["ajs-destination"],{

/***/ "./node_modules/@segment/analytics-next/dist/pkg/lib/is-plan-event-enabled.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@segment/analytics-next/dist/pkg/lib/is-plan-event-enabled.js ***!
  \************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isPlanEventEnabled: function() { return /* binding */ isPlanEventEnabled; }\n/* harmony export */ });\n/**\n * Determines whether a track event is allowed to be sent based on the\n * user's tracking plan.\n * If the user does not have a tracking plan or the event is allowed based\n * on the tracking plan configuration, returns true.\n */\nfunction isPlanEventEnabled(plan, planEvent) {\n    var _a, _b;\n    // Always prioritize the event's `enabled` status\n    if (typeof (planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) === 'boolean') {\n        return planEvent.enabled;\n    }\n    // Assume absence of a tracking plan means events are enabled\n    return (_b = (_a = plan === null || plan === void 0 ? void 0 : plan.__default) === null || _a === void 0 ? void 0 : _a.enabled) !== null && _b !== void 0 ? _b : true;\n}\n//# sourceMappingURL=is-plan-event-enabled.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5leHQvZGlzdC9wa2cvbGliL2lzLXBsYW4tZXZlbnQtZW5hYmxlZC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1uZXh0L2Rpc3QvcGtnL2xpYi9pcy1wbGFuLWV2ZW50LWVuYWJsZWQuanM/OTJmYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERldGVybWluZXMgd2hldGhlciBhIHRyYWNrIGV2ZW50IGlzIGFsbG93ZWQgdG8gYmUgc2VudCBiYXNlZCBvbiB0aGVcbiAqIHVzZXIncyB0cmFja2luZyBwbGFuLlxuICogSWYgdGhlIHVzZXIgZG9lcyBub3QgaGF2ZSBhIHRyYWNraW5nIHBsYW4gb3IgdGhlIGV2ZW50IGlzIGFsbG93ZWQgYmFzZWRcbiAqIG9uIHRoZSB0cmFja2luZyBwbGFuIGNvbmZpZ3VyYXRpb24sIHJldHVybnMgdHJ1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUGxhbkV2ZW50RW5hYmxlZChwbGFuLCBwbGFuRXZlbnQpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIC8vIEFsd2F5cyBwcmlvcml0aXplIHRoZSBldmVudCdzIGBlbmFibGVkYCBzdGF0dXNcbiAgICBpZiAodHlwZW9mIChwbGFuRXZlbnQgPT09IG51bGwgfHwgcGxhbkV2ZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbGFuRXZlbnQuZW5hYmxlZCkgPT09ICdib29sZWFuJykge1xuICAgICAgICByZXR1cm4gcGxhbkV2ZW50LmVuYWJsZWQ7XG4gICAgfVxuICAgIC8vIEFzc3VtZSBhYnNlbmNlIG9mIGEgdHJhY2tpbmcgcGxhbiBtZWFucyBldmVudHMgYXJlIGVuYWJsZWRcbiAgICByZXR1cm4gKF9iID0gKF9hID0gcGxhbiA9PT0gbnVsbCB8fCBwbGFuID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbGFuLl9fZGVmYXVsdCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVuYWJsZWQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHRydWU7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pcy1wbGFuLWV2ZW50LWVuYWJsZWQuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@segment/analytics-next/dist/pkg/lib/is-plan-event-enabled.js\n"));

/***/ }),

/***/ "./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/index.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/index.js ***!
  \****************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LegacyDestination: function() { return /* binding */ LegacyDestination; },\n/* harmony export */   ajsDestinations: function() { return /* binding */ ajsDestinations; }\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _segment_facade__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @segment/facade */ \"./node_modules/@segment/facade/dist/index.js\");\n/* harmony import */ var _segment_facade__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_segment_facade__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _core_connection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/connection */ \"./node_modules/@segment/analytics-next/dist/pkg/core/connection/index.js\");\n/* harmony import */ var _core_context__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/context */ \"./node_modules/@segment/analytics-next/dist/pkg/core/context/index.js\");\n/* harmony import */ var _core_environment__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/environment */ \"./node_modules/@segment/analytics-next/dist/pkg/core/environment/index.js\");\n/* harmony import */ var _segment_analytics_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @segment/analytics-core */ \"./node_modules/@segment/analytics-core/dist/esm/index.js\");\n/* harmony import */ var _lib_is_plan_event_enabled__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../lib/is-plan-event-enabled */ \"./node_modules/@segment/analytics-next/dist/pkg/lib/is-plan-event-enabled.js\");\n/* harmony import */ var _lib_merged_options__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../lib/merged-options */ \"./node_modules/@segment/analytics-next/dist/pkg/lib/merged-options.js\");\n/* harmony import */ var _lib_p_while__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/p-while */ \"./node_modules/@segment/analytics-next/dist/pkg/lib/p-while.js\");\n/* harmony import */ var _lib_priority_queue__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../lib/priority-queue */ \"./node_modules/@segment/analytics-next/dist/pkg/lib/priority-queue/index.js\");\n/* harmony import */ var _lib_priority_queue_persisted__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../lib/priority-queue/persisted */ \"./node_modules/@segment/analytics-next/dist/pkg/lib/priority-queue/persisted.js\");\n/* harmony import */ var _middleware__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../middleware */ \"./node_modules/@segment/analytics-next/dist/pkg/plugins/middleware/index.js\");\n/* harmony import */ var _loader__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./loader */ \"./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/loader.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./utils */ \"./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/utils.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction flushQueue(xt, queue) {\n    return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n        var failedQueue;\n        var _this = this;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    failedQueue = [];\n                    if ((0,_core_connection__WEBPACK_IMPORTED_MODULE_2__.isOffline)()) {\n                        return [2 /*return*/, queue];\n                    }\n                    return [4 /*yield*/, (0,_lib_p_while__WEBPACK_IMPORTED_MODULE_3__.pWhile)(function () { return queue.length > 0 && (0,_core_connection__WEBPACK_IMPORTED_MODULE_2__.isOnline)(); }, function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(_this, void 0, void 0, function () {\n                            var ctx, result, success;\n                            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        ctx = queue.pop();\n                                        if (!ctx) {\n                                            return [2 /*return*/];\n                                        }\n                                        return [4 /*yield*/, (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_4__.attempt)(ctx, xt)];\n                                    case 1:\n                                        result = _a.sent();\n                                        success = result instanceof _core_context__WEBPACK_IMPORTED_MODULE_5__.Context;\n                                        if (!success) {\n                                            failedQueue.push(ctx);\n                                        }\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); })\n                        // re-add failed tasks\n                    ];\n                case 1:\n                    _a.sent();\n                    // re-add failed tasks\n                    failedQueue.map(function (failed) { return queue.pushWithBackoff(failed); });\n                    return [2 /*return*/, queue];\n            }\n        });\n    });\n}\nvar LegacyDestination = /** @class */ (function () {\n    function LegacyDestination(name, version, writeKey, settings, options, integrationSource) {\n        if (settings === void 0) { settings = {}; }\n        this.options = {};\n        this.type = 'destination';\n        this.middleware = [];\n        this._ready = false;\n        this._initialized = false;\n        this.flushing = false;\n        this.name = name;\n        this.version = version;\n        this.settings = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, settings);\n        this.disableAutoISOConversion = options.disableAutoISOConversion || false;\n        this.integrationSource = integrationSource;\n        // AJS-Renderer sets an extraneous `type` setting that clobbers\n        // existing type defaults. We need to remove it if it's present\n        if (this.settings['type'] && this.settings['type'] === 'browser') {\n            delete this.settings['type'];\n        }\n        this.options = options;\n        this.buffer = options.disableClientPersistence\n            ? new _lib_priority_queue__WEBPACK_IMPORTED_MODULE_6__.PriorityQueue(4, [])\n            : new _lib_priority_queue_persisted__WEBPACK_IMPORTED_MODULE_7__.PersistedPriorityQueue(4, \"\".concat(writeKey, \":dest-\").concat(name));\n        this.scheduleFlush();\n    }\n    LegacyDestination.prototype.isLoaded = function () {\n        return this._ready;\n    };\n    LegacyDestination.prototype.ready = function () {\n        var _a;\n        return (_a = this.onReady) !== null && _a !== void 0 ? _a : Promise.resolve();\n    };\n    LegacyDestination.prototype.load = function (ctx, analyticsInstance) {\n        var _a;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n            var integrationSource, _b;\n            var _this = this;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this._ready || this.onReady !== undefined) {\n                            return [2 /*return*/];\n                        }\n                        if (!((_a = this.integrationSource) !== null && _a !== void 0)) return [3 /*break*/, 1];\n                        _b = _a;\n                        return [3 /*break*/, 3];\n                    case 1: return [4 /*yield*/, (0,_loader__WEBPACK_IMPORTED_MODULE_8__.loadIntegration)(ctx, this.name, this.version, this.options.obfuscate)];\n                    case 2:\n                        _b = (_c.sent());\n                        _c.label = 3;\n                    case 3:\n                        integrationSource = _b;\n                        this.integration = (0,_loader__WEBPACK_IMPORTED_MODULE_8__.buildIntegration)(integrationSource, this.settings, analyticsInstance);\n                        this.onReady = new Promise(function (resolve) {\n                            var onReadyFn = function () {\n                                _this._ready = true;\n                                resolve(true);\n                            };\n                            _this.integration.once('ready', onReadyFn);\n                        });\n                        this.onInitialize = new Promise(function (resolve) {\n                            var onInit = function () {\n                                _this._initialized = true;\n                                resolve(true);\n                            };\n                            _this.integration.on('initialize', onInit);\n                        });\n                        try {\n                            ctx.stats.increment('analytics_js.integration.invoke', 1, [\n                                \"method:initialize\",\n                                \"integration_name:\".concat(this.name),\n                            ]);\n                            this.integration.initialize();\n                        }\n                        catch (error) {\n                            ctx.stats.increment('analytics_js.integration.invoke.error', 1, [\n                                \"method:initialize\",\n                                \"integration_name:\".concat(this.name),\n                            ]);\n                            throw error;\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    LegacyDestination.prototype.unload = function (_ctx, _analyticsInstance) {\n        return (0,_loader__WEBPACK_IMPORTED_MODULE_8__.unloadIntegration)(this.name, this.version, this.options.obfuscate);\n    };\n    LegacyDestination.prototype.addMiddleware = function () {\n        var _a;\n        var fn = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            fn[_i] = arguments[_i];\n        }\n        this.middleware = (_a = this.middleware).concat.apply(_a, fn);\n    };\n    LegacyDestination.prototype.shouldBuffer = function (ctx) {\n        return (\n        // page events can't be buffered because of destinations that automatically add page views\n        ctx.event.type !== 'page' &&\n            ((0,_core_connection__WEBPACK_IMPORTED_MODULE_2__.isOffline)() || this._ready === false || this._initialized === false));\n    };\n    LegacyDestination.prototype.send = function (ctx, clz, eventType) {\n        var _a, _b;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n            var plan, ev, planEvent, afterMiddleware, event, err_1;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this.shouldBuffer(ctx)) {\n                            this.buffer.push(ctx);\n                            this.scheduleFlush();\n                            return [2 /*return*/, ctx];\n                        }\n                        plan = (_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.plan) === null || _b === void 0 ? void 0 : _b.track;\n                        ev = ctx.event.event;\n                        if (plan && ev && this.name !== 'Segment.io') {\n                            planEvent = plan[ev];\n                            if (!(0,_lib_is_plan_event_enabled__WEBPACK_IMPORTED_MODULE_9__.isPlanEventEnabled)(plan, planEvent)) {\n                                ctx.updateEvent('integrations', (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, ctx.event.integrations), { All: false, 'Segment.io': true }));\n                                ctx.cancel(new _core_context__WEBPACK_IMPORTED_MODULE_5__.ContextCancelation({\n                                    retry: false,\n                                    reason: \"Event \".concat(ev, \" disabled for integration \").concat(this.name, \" in tracking plan\"),\n                                    type: 'Dropped by plan',\n                                }));\n                                return [2 /*return*/, ctx];\n                            }\n                            else {\n                                ctx.updateEvent('integrations', (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, ctx.event.integrations), planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations));\n                            }\n                            if ((planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) && (planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations[this.name]) === false) {\n                                ctx.cancel(new _core_context__WEBPACK_IMPORTED_MODULE_5__.ContextCancelation({\n                                    retry: false,\n                                    reason: \"Event \".concat(ev, \" disabled for integration \").concat(this.name, \" in tracking plan\"),\n                                    type: 'Dropped by plan',\n                                }));\n                                return [2 /*return*/, ctx];\n                            }\n                        }\n                        return [4 /*yield*/, (0,_middleware__WEBPACK_IMPORTED_MODULE_10__.applyDestinationMiddleware)(this.name, ctx.event, this.middleware)];\n                    case 1:\n                        afterMiddleware = _c.sent();\n                        if (afterMiddleware === null) {\n                            return [2 /*return*/, ctx];\n                        }\n                        event = new clz(afterMiddleware, {\n                            traverse: !this.disableAutoISOConversion,\n                        });\n                        ctx.stats.increment('analytics_js.integration.invoke', 1, [\n                            \"method:\".concat(eventType),\n                            \"integration_name:\".concat(this.name),\n                        ]);\n                        _c.label = 2;\n                    case 2:\n                        _c.trys.push([2, 5, , 6]);\n                        if (!this.integration) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.integration.invoke.call(this.integration, eventType, event)];\n                    case 3:\n                        _c.sent();\n                        _c.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _c.sent();\n                        ctx.stats.increment('analytics_js.integration.invoke.error', 1, [\n                            \"method:\".concat(eventType),\n                            \"integration_name:\".concat(this.name),\n                        ]);\n                        throw err_1;\n                    case 6: return [2 /*return*/, ctx];\n                }\n            });\n        });\n    };\n    LegacyDestination.prototype.track = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, _segment_facade__WEBPACK_IMPORTED_MODULE_0__.Track, 'track')];\n            });\n        });\n    };\n    LegacyDestination.prototype.page = function (ctx) {\n        var _a;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n            var _this = this;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_b) {\n                if (((_a = this.integration) === null || _a === void 0 ? void 0 : _a._assumesPageview) && !this._initialized) {\n                    this.integration.initialize();\n                }\n                return [2 /*return*/, this.onInitialize.then(function () {\n                        return _this.send(ctx, _segment_facade__WEBPACK_IMPORTED_MODULE_0__.Page, 'page');\n                    })];\n            });\n        });\n    };\n    LegacyDestination.prototype.identify = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, _segment_facade__WEBPACK_IMPORTED_MODULE_0__.Identify, 'identify')];\n            });\n        });\n    };\n    LegacyDestination.prototype.alias = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, _segment_facade__WEBPACK_IMPORTED_MODULE_0__.Alias, 'alias')];\n            });\n        });\n    };\n    LegacyDestination.prototype.group = function (ctx) {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {\n                return [2 /*return*/, this.send(ctx, _segment_facade__WEBPACK_IMPORTED_MODULE_0__.Group, 'group')];\n            });\n        });\n    };\n    LegacyDestination.prototype.scheduleFlush = function () {\n        var _this = this;\n        if (this.flushing) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-misused-promises\n        setTimeout(function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(_this, void 0, void 0, function () {\n            var _a;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.flushing = true;\n                        _a = this;\n                        return [4 /*yield*/, flushQueue(this, this.buffer)];\n                    case 1:\n                        _a.buffer = _b.sent();\n                        this.flushing = false;\n                        if (this.buffer.todo > 0) {\n                            this.scheduleFlush();\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        }); }, Math.random() * 5000);\n    };\n    return LegacyDestination;\n}());\n\nfunction ajsDestinations(writeKey, settings, globalIntegrations, options, routingMiddleware, legacyIntegrationSources) {\n    var _a, _b;\n    if (globalIntegrations === void 0) { globalIntegrations = {}; }\n    if (options === void 0) { options = {}; }\n    if ((0,_core_environment__WEBPACK_IMPORTED_MODULE_11__.isServer)()) {\n        return [];\n    }\n    if (settings.plan) {\n        options = options !== null && options !== void 0 ? options : {};\n        options.plan = settings.plan;\n    }\n    var routingRules = (_b = (_a = settings.middlewareSettings) === null || _a === void 0 ? void 0 : _a.routingRules) !== null && _b !== void 0 ? _b : [];\n    var remoteIntegrationsConfig = settings.integrations;\n    var localIntegrationsConfig = options.integrations;\n    // merged remote CDN settings with user provided options\n    var integrationOptions = (0,_lib_merged_options__WEBPACK_IMPORTED_MODULE_12__.mergedOptions)(settings, options !== null && options !== void 0 ? options : {});\n    var adhocIntegrationSources = legacyIntegrationSources === null || legacyIntegrationSources === void 0 ? void 0 : legacyIntegrationSources.reduce(function (acc, integrationSource) {\n        var _a;\n        return ((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, acc), (_a = {}, _a[(0,_loader__WEBPACK_IMPORTED_MODULE_8__.resolveIntegrationNameFromSource)(integrationSource)] = integrationSource, _a)));\n    }, {});\n    var installableIntegrations = new Set((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__spreadArray)([], Object.keys(remoteIntegrationsConfig).filter(function (name) {\n        return (0,_utils__WEBPACK_IMPORTED_MODULE_13__.isInstallableIntegration)(name, remoteIntegrationsConfig[name]);\n    }), true), Object.keys(adhocIntegrationSources || {}).filter(function (name) {\n        return (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_4__.isPlainObject)(remoteIntegrationsConfig[name]) ||\n            (0,_segment_analytics_core__WEBPACK_IMPORTED_MODULE_4__.isPlainObject)(localIntegrationsConfig === null || localIntegrationsConfig === void 0 ? void 0 : localIntegrationsConfig[name]);\n    }), true));\n    return Array.from(installableIntegrations)\n        .filter(function (name) { return !(0,_utils__WEBPACK_IMPORTED_MODULE_13__.isDisabledIntegration)(name, globalIntegrations); })\n        .map(function (name) {\n        var integrationSettings = remoteIntegrationsConfig[name];\n        var version = (0,_loader__WEBPACK_IMPORTED_MODULE_8__.resolveVersion)(integrationSettings);\n        var destination = new LegacyDestination(name, version, writeKey, integrationOptions[name], options, adhocIntegrationSources === null || adhocIntegrationSources === void 0 ? void 0 : adhocIntegrationSources[name]);\n        var routing = routingRules.filter(function (rule) { return rule.destinationName === name; });\n        if (routing.length > 0 && routingMiddleware) {\n            destination.addMiddleware(routingMiddleware);\n        }\n        return destination;\n    });\n}\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5leHQvZGlzdC9wa2cvcGx1Z2lucy9hanMtZGVzdGluYXRpb24vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd0U7QUFDRjtBQUNWO0FBQ0s7QUFDZjtBQUNBO0FBQ21CO0FBQ1o7QUFDZDtBQUNjO0FBQ21CO0FBQ2hCO0FBQ3VFO0FBQzNFO0FBQzRDO0FBQ3BHO0FBQ0EsV0FBVyxnREFBUztBQUNwQjtBQUNBO0FBQ0EsZUFBZSxrREFBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkRBQVM7QUFDakM7QUFDQTtBQUNBLHlDQUF5QyxvREFBTSxlQUFlLDJCQUEyQiwwREFBUSxLQUFLLGdCQUFnQixPQUFPLGdEQUFTO0FBQ3RJO0FBQ0EsbUNBQW1DLGtEQUFXO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxnRUFBTztBQUNwRTtBQUNBO0FBQ0Esb0VBQW9FLGtEQUFPO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0IseUJBQXlCLElBQUk7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCx1Q0FBdUM7QUFDL0Y7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsK0NBQVEsR0FBRztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsOERBQWE7QUFDL0Isa0JBQWtCLGlGQUFzQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QjtBQUNBO0FBQ0EsbUJBQW1CLGtEQUFXO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsd0RBQWU7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyx5REFBZ0I7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGVBQWUsMERBQWlCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSwyREFBUztBQUN0QjtBQUNBO0FBQ0E7QUFDQSxlQUFlLGdEQUFTO0FBQ3hCO0FBQ0EsbUJBQW1CLGtEQUFXO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsOEVBQWtCO0FBQ25ELGdFQUFnRSwrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsNkJBQTZCLGdDQUFnQztBQUNqSiwrQ0FBK0MsNkRBQWtCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHO0FBQ3BGO0FBQ0E7QUFDQSwrQ0FBK0MsNkRBQWtCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsd0VBQTBCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QixtQkFBbUIsa0RBQVc7QUFDOUIscURBQXFELGtEQUFLO0FBQzFELGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QjtBQUNBLG1CQUFtQixrREFBVztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxpREFBSTtBQUNuRCxxQkFBcUI7QUFDckIsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSxnREFBUztBQUN4QixtQkFBbUIsa0RBQVc7QUFDOUIscURBQXFELHFEQUFRO0FBQzdELGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGVBQWUsZ0RBQVM7QUFDeEIsbUJBQW1CLGtEQUFXO0FBQzlCLHFEQUFxRCxrREFBSztBQUMxRCxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxlQUFlLGdEQUFTO0FBQ3hCLG1CQUFtQixrREFBVztBQUM5QixxREFBcUQsa0RBQUs7QUFDMUQsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxPQUFPLGdEQUFTO0FBQ2pEO0FBQ0EsbUJBQW1CLGtEQUFXO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVMsSUFBSTtBQUNiO0FBQ0E7QUFDQSxDQUFDO0FBQzRCO0FBQ3RCO0FBQ1A7QUFDQSx5Q0FBeUM7QUFDekMsOEJBQThCO0FBQzlCLFFBQVEsNERBQVE7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsbUVBQWEsZ0VBQWdFO0FBQzFHO0FBQ0E7QUFDQSxnQkFBZ0IsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHLGdCQUFnQixLQUFLLHlFQUFnQztBQUN6RixLQUFLLElBQUk7QUFDVCwwQ0FBMEMsb0RBQWEsQ0FBQyxvREFBYTtBQUNyRSxlQUFlLGlFQUF3QjtBQUN2QyxLQUFLLG1EQUFtRDtBQUN4RCxlQUFlLHNFQUFhO0FBQzVCLFlBQVksc0VBQWE7QUFDekIsS0FBSztBQUNMO0FBQ0Esa0NBQWtDLFFBQVEsOERBQXFCLDZCQUE2QjtBQUM1RjtBQUNBO0FBQ0Esc0JBQXNCLHVEQUFjO0FBQ3BDO0FBQ0EsNERBQTRELHVDQUF1QztBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9Ac2VnbWVudC9hbmFseXRpY3MtbmV4dC9kaXN0L3BrZy9wbHVnaW5zL2Fqcy1kZXN0aW5hdGlvbi9pbmRleC5qcz8yNDg5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF9fYXNzaWduLCBfX2F3YWl0ZXIsIF9fZ2VuZXJhdG9yLCBfX3NwcmVhZEFycmF5IH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBBbGlhcywgR3JvdXAsIElkZW50aWZ5LCBQYWdlLCBUcmFjayB9IGZyb20gJ0BzZWdtZW50L2ZhY2FkZSc7XG5pbXBvcnQgeyBpc09mZmxpbmUsIGlzT25saW5lIH0gZnJvbSAnLi4vLi4vY29yZS9jb25uZWN0aW9uJztcbmltcG9ydCB7IENvbnRleHQsIENvbnRleHRDYW5jZWxhdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvY29udGV4dCc7XG5pbXBvcnQgeyBpc1NlcnZlciB9IGZyb20gJy4uLy4uL2NvcmUvZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgYXR0ZW1wdCB9IGZyb20gJ0BzZWdtZW50L2FuYWx5dGljcy1jb3JlJztcbmltcG9ydCB7IGlzUGxhbkV2ZW50RW5hYmxlZCB9IGZyb20gJy4uLy4uL2xpYi9pcy1wbGFuLWV2ZW50LWVuYWJsZWQnO1xuaW1wb3J0IHsgbWVyZ2VkT3B0aW9ucyB9IGZyb20gJy4uLy4uL2xpYi9tZXJnZWQtb3B0aW9ucyc7XG5pbXBvcnQgeyBwV2hpbGUgfSBmcm9tICcuLi8uLi9saWIvcC13aGlsZSc7XG5pbXBvcnQgeyBQcmlvcml0eVF1ZXVlIH0gZnJvbSAnLi4vLi4vbGliL3ByaW9yaXR5LXF1ZXVlJztcbmltcG9ydCB7IFBlcnNpc3RlZFByaW9yaXR5UXVldWUgfSBmcm9tICcuLi8uLi9saWIvcHJpb3JpdHktcXVldWUvcGVyc2lzdGVkJztcbmltcG9ydCB7IGFwcGx5RGVzdGluYXRpb25NaWRkbGV3YXJlLCB9IGZyb20gJy4uL21pZGRsZXdhcmUnO1xuaW1wb3J0IHsgYnVpbGRJbnRlZ3JhdGlvbiwgbG9hZEludGVncmF0aW9uLCByZXNvbHZlSW50ZWdyYXRpb25OYW1lRnJvbVNvdXJjZSwgcmVzb2x2ZVZlcnNpb24sIHVubG9hZEludGVncmF0aW9uLCB9IGZyb20gJy4vbG9hZGVyJztcbmltcG9ydCB7IGlzUGxhaW5PYmplY3QgfSBmcm9tICdAc2VnbWVudC9hbmFseXRpY3MtY29yZSc7XG5pbXBvcnQgeyBpc0Rpc2FibGVkSW50ZWdyYXRpb24gYXMgc2hvdWxkU2tpcEludGVncmF0aW9uLCBpc0luc3RhbGxhYmxlSW50ZWdyYXRpb24sIH0gZnJvbSAnLi91dGlscyc7XG5mdW5jdGlvbiBmbHVzaFF1ZXVlKHh0LCBxdWV1ZSkge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZhaWxlZFF1ZXVlO1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBmYWlsZWRRdWV1ZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNPZmZsaW5lKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBxdWV1ZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcFdoaWxlKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHF1ZXVlLmxlbmd0aCA+IDAgJiYgaXNPbmxpbmUoKTsgfSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdHgsIHJlc3VsdCwgc3VjY2VzcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHggPSBxdWV1ZS5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWN0eCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGF0dGVtcHQoY3R4LCB4dCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gcmVzdWx0IGluc3RhbmNlb2YgQ29udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkUXVldWUucHVzaChjdHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmUtYWRkIGZhaWxlZCB0YXNrc1xuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAvLyByZS1hZGQgZmFpbGVkIHRhc2tzXG4gICAgICAgICAgICAgICAgICAgIGZhaWxlZFF1ZXVlLm1hcChmdW5jdGlvbiAoZmFpbGVkKSB7IHJldHVybiBxdWV1ZS5wdXNoV2l0aEJhY2tvZmYoZmFpbGVkKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBxdWV1ZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxudmFyIExlZ2FjeURlc3RpbmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExlZ2FjeURlc3RpbmF0aW9uKG5hbWUsIHZlcnNpb24sIHdyaXRlS2V5LCBzZXR0aW5ncywgb3B0aW9ucywgaW50ZWdyYXRpb25Tb3VyY2UpIHtcbiAgICAgICAgaWYgKHNldHRpbmdzID09PSB2b2lkIDApIHsgc2V0dGluZ3MgPSB7fTsgfVxuICAgICAgICB0aGlzLm9wdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy50eXBlID0gJ2Rlc3RpbmF0aW9uJztcbiAgICAgICAgdGhpcy5taWRkbGV3YXJlID0gW107XG4gICAgICAgIHRoaXMuX3JlYWR5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZmx1c2hpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IF9fYXNzaWduKHt9LCBzZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuZGlzYWJsZUF1dG9JU09Db252ZXJzaW9uID0gb3B0aW9ucy5kaXNhYmxlQXV0b0lTT0NvbnZlcnNpb24gfHwgZmFsc2U7XG4gICAgICAgIHRoaXMuaW50ZWdyYXRpb25Tb3VyY2UgPSBpbnRlZ3JhdGlvblNvdXJjZTtcbiAgICAgICAgLy8gQUpTLVJlbmRlcmVyIHNldHMgYW4gZXh0cmFuZW91cyBgdHlwZWAgc2V0dGluZyB0aGF0IGNsb2JiZXJzXG4gICAgICAgIC8vIGV4aXN0aW5nIHR5cGUgZGVmYXVsdHMuIFdlIG5lZWQgdG8gcmVtb3ZlIGl0IGlmIGl0J3MgcHJlc2VudFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5nc1sndHlwZSddICYmIHRoaXMuc2V0dGluZ3NbJ3R5cGUnXSA9PT0gJ2Jyb3dzZXInKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5zZXR0aW5nc1sndHlwZSddO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gb3B0aW9ucy5kaXNhYmxlQ2xpZW50UGVyc2lzdGVuY2VcbiAgICAgICAgICAgID8gbmV3IFByaW9yaXR5UXVldWUoNCwgW10pXG4gICAgICAgICAgICA6IG5ldyBQZXJzaXN0ZWRQcmlvcml0eVF1ZXVlKDQsIFwiXCIuY29uY2F0KHdyaXRlS2V5LCBcIjpkZXN0LVwiKS5jb25jYXQobmFtZSkpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlRmx1c2goKTtcbiAgICB9XG4gICAgTGVnYWN5RGVzdGluYXRpb24ucHJvdG90eXBlLmlzTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVhZHk7XG4gICAgfTtcbiAgICBMZWdhY3lEZXN0aW5hdGlvbi5wcm90b3R5cGUucmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IHRoaXMub25SZWFkeSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfTtcbiAgICBMZWdhY3lEZXN0aW5hdGlvbi5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChjdHgsIGFuYWx5dGljc0luc3RhbmNlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGludGVncmF0aW9uU291cmNlLCBfYjtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVhZHkgfHwgdGhpcy5vblJlYWR5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISgoX2EgPSB0aGlzLmludGVncmF0aW9uU291cmNlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFs0IC8qeWllbGQqLywgbG9hZEludGVncmF0aW9uKGN0eCwgdGhpcy5uYW1lLCB0aGlzLnZlcnNpb24sIHRoaXMub3B0aW9ucy5vYmZ1c2NhdGUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSAoX2Muc2VudCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZWdyYXRpb25Tb3VyY2UgPSBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW50ZWdyYXRpb24gPSBidWlsZEludGVncmF0aW9uKGludGVncmF0aW9uU291cmNlLCB0aGlzLnNldHRpbmdzLCBhbmFseXRpY3NJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uUmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvblJlYWR5Rm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9yZWFkeSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbnRlZ3JhdGlvbi5vbmNlKCdyZWFkeScsIG9uUmVhZHlGbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Jbml0aWFsaXplID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5faW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW50ZWdyYXRpb24ub24oJ2luaXRpYWxpemUnLCBvbkluaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdGF0cy5pbmNyZW1lbnQoJ2FuYWx5dGljc19qcy5pbnRlZ3JhdGlvbi5pbnZva2UnLCAxLCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWV0aG9kOmluaXRpYWxpemVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnRlZ3JhdGlvbl9uYW1lOlwiLmNvbmNhdCh0aGlzLm5hbWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW50ZWdyYXRpb24uaW5pdGlhbGl6ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0YXRzLmluY3JlbWVudCgnYW5hbHl0aWNzX2pzLmludGVncmF0aW9uLmludm9rZS5lcnJvcicsIDEsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRob2Q6aW5pdGlhbGl6ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImludGVncmF0aW9uX25hbWU6XCIuY29uY2F0KHRoaXMubmFtZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTGVnYWN5RGVzdGluYXRpb24ucHJvdG90eXBlLnVubG9hZCA9IGZ1bmN0aW9uIChfY3R4LCBfYW5hbHl0aWNzSW5zdGFuY2UpIHtcbiAgICAgICAgcmV0dXJuIHVubG9hZEludGVncmF0aW9uKHRoaXMubmFtZSwgdGhpcy52ZXJzaW9uLCB0aGlzLm9wdGlvbnMub2JmdXNjYXRlKTtcbiAgICB9O1xuICAgIExlZ2FjeURlc3RpbmF0aW9uLnByb3RvdHlwZS5hZGRNaWRkbGV3YXJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBmbiA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgZm5bX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1pZGRsZXdhcmUgPSAoX2EgPSB0aGlzLm1pZGRsZXdhcmUpLmNvbmNhdC5hcHBseShfYSwgZm4pO1xuICAgIH07XG4gICAgTGVnYWN5RGVzdGluYXRpb24ucHJvdG90eXBlLnNob3VsZEJ1ZmZlciA9IGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgLy8gcGFnZSBldmVudHMgY2FuJ3QgYmUgYnVmZmVyZWQgYmVjYXVzZSBvZiBkZXN0aW5hdGlvbnMgdGhhdCBhdXRvbWF0aWNhbGx5IGFkZCBwYWdlIHZpZXdzXG4gICAgICAgIGN0eC5ldmVudC50eXBlICE9PSAncGFnZScgJiZcbiAgICAgICAgICAgIChpc09mZmxpbmUoKSB8fCB0aGlzLl9yZWFkeSA9PT0gZmFsc2UgfHwgdGhpcy5faW5pdGlhbGl6ZWQgPT09IGZhbHNlKSk7XG4gICAgfTtcbiAgICBMZWdhY3lEZXN0aW5hdGlvbi5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChjdHgsIGNseiwgZXZlbnRUeXBlKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwbGFuLCBldiwgcGxhbkV2ZW50LCBhZnRlck1pZGRsZXdhcmUsIGV2ZW50LCBlcnJfMTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZEJ1ZmZlcihjdHgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWZmZXIucHVzaChjdHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVGbHVzaCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBjdHhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhbiA9IChfYiA9IChfYSA9IHRoaXMub3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBsYW4pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi50cmFjaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ID0gY3R4LmV2ZW50LmV2ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsYW4gJiYgZXYgJiYgdGhpcy5uYW1lICE9PSAnU2VnbWVudC5pbycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFuRXZlbnQgPSBwbGFuW2V2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzUGxhbkV2ZW50RW5hYmxlZChwbGFuLCBwbGFuRXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC51cGRhdGVFdmVudCgnaW50ZWdyYXRpb25zJywgX19hc3NpZ24oX19hc3NpZ24oe30sIGN0eC5ldmVudC5pbnRlZ3JhdGlvbnMpLCB7IEFsbDogZmFsc2UsICdTZWdtZW50LmlvJzogdHJ1ZSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5jYW5jZWwobmV3IENvbnRleHRDYW5jZWxhdGlvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb246IFwiRXZlbnQgXCIuY29uY2F0KGV2LCBcIiBkaXNhYmxlZCBmb3IgaW50ZWdyYXRpb24gXCIpLmNvbmNhdCh0aGlzLm5hbWUsIFwiIGluIHRyYWNraW5nIHBsYW5cIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRHJvcHBlZCBieSBwbGFuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgY3R4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC51cGRhdGVFdmVudCgnaW50ZWdyYXRpb25zJywgX19hc3NpZ24oX19hc3NpZ24oe30sIGN0eC5ldmVudC5pbnRlZ3JhdGlvbnMpLCBwbGFuRXZlbnQgPT09IG51bGwgfHwgcGxhbkV2ZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbGFuRXZlbnQuaW50ZWdyYXRpb25zKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocGxhbkV2ZW50ID09PSBudWxsIHx8IHBsYW5FdmVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGxhbkV2ZW50LmVuYWJsZWQpICYmIChwbGFuRXZlbnQgPT09IG51bGwgfHwgcGxhbkV2ZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbGFuRXZlbnQuaW50ZWdyYXRpb25zW3RoaXMubmFtZV0pID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguY2FuY2VsKG5ldyBDb250ZXh0Q2FuY2VsYXRpb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cnk6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uOiBcIkV2ZW50IFwiLmNvbmNhdChldiwgXCIgZGlzYWJsZWQgZm9yIGludGVncmF0aW9uIFwiKS5jb25jYXQodGhpcy5uYW1lLCBcIiBpbiB0cmFja2luZyBwbGFuXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0Ryb3BwZWQgYnkgcGxhbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGN0eF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYXBwbHlEZXN0aW5hdGlvbk1pZGRsZXdhcmUodGhpcy5uYW1lLCBjdHguZXZlbnQsIHRoaXMubWlkZGxld2FyZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlck1pZGRsZXdhcmUgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWZ0ZXJNaWRkbGV3YXJlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGN0eF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IG5ldyBjbHooYWZ0ZXJNaWRkbGV3YXJlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhdmVyc2U6ICF0aGlzLmRpc2FibGVBdXRvSVNPQ29udmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0YXRzLmluY3JlbWVudCgnYW5hbHl0aWNzX2pzLmludGVncmF0aW9uLmludm9rZScsIDEsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1ldGhvZDpcIi5jb25jYXQoZXZlbnRUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImludGVncmF0aW9uX25hbWU6XCIuY29uY2F0KHRoaXMubmFtZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudHJ5cy5wdXNoKFsyLCA1LCAsIDZdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbnRlZ3JhdGlvbikgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmludGVncmF0aW9uLmludm9rZS5jYWxsKHRoaXMuaW50ZWdyYXRpb24sIGV2ZW50VHlwZSwgZXZlbnQpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdGF0cy5pbmNyZW1lbnQoJ2FuYWx5dGljc19qcy5pbnRlZ3JhdGlvbi5pbnZva2UuZXJyb3InLCAxLCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRob2Q6XCIuY29uY2F0KGV2ZW50VHlwZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnRlZ3JhdGlvbl9uYW1lOlwiLmNvbmNhdCh0aGlzLm5hbWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJfMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qLywgY3R4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBMZWdhY3lEZXN0aW5hdGlvbi5wcm90b3R5cGUudHJhY2sgPSBmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5zZW5kKGN0eCwgVHJhY2ssICd0cmFjaycpXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIExlZ2FjeURlc3RpbmF0aW9uLnByb3RvdHlwZS5wYWdlID0gZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgaWYgKCgoX2EgPSB0aGlzLmludGVncmF0aW9uKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuX2Fzc3VtZXNQYWdldmlldykgJiYgIXRoaXMuX2luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW50ZWdyYXRpb24uaW5pdGlhbGl6ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5vbkluaXRpYWxpemUudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc2VuZChjdHgsIFBhZ2UsICdwYWdlJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIExlZ2FjeURlc3RpbmF0aW9uLnByb3RvdHlwZS5pZGVudGlmeSA9IGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnNlbmQoY3R4LCBJZGVudGlmeSwgJ2lkZW50aWZ5JyldO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTGVnYWN5RGVzdGluYXRpb24ucHJvdG90eXBlLmFsaWFzID0gZnVuY3Rpb24gKGN0eCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuc2VuZChjdHgsIEFsaWFzLCAnYWxpYXMnKV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBMZWdhY3lEZXN0aW5hdGlvbi5wcm90b3R5cGUuZ3JvdXAgPSBmdW5jdGlvbiAoY3R4KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5zZW5kKGN0eCwgR3JvdXAsICdncm91cCcpXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIExlZ2FjeURlc3RpbmF0aW9uLnByb3RvdHlwZS5zY2hlZHVsZUZsdXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5mbHVzaGluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbWlzdXNlZC1wcm9taXNlc1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmx1c2hpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZmx1c2hRdWV1ZSh0aGlzLCB0aGlzLmJ1ZmZlcildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5idWZmZXIgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZsdXNoaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5idWZmZXIudG9kbyA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlRmx1c2goKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IH0sIE1hdGgucmFuZG9tKCkgKiA1MDAwKTtcbiAgICB9O1xuICAgIHJldHVybiBMZWdhY3lEZXN0aW5hdGlvbjtcbn0oKSk7XG5leHBvcnQgeyBMZWdhY3lEZXN0aW5hdGlvbiB9O1xuZXhwb3J0IGZ1bmN0aW9uIGFqc0Rlc3RpbmF0aW9ucyh3cml0ZUtleSwgc2V0dGluZ3MsIGdsb2JhbEludGVncmF0aW9ucywgb3B0aW9ucywgcm91dGluZ01pZGRsZXdhcmUsIGxlZ2FjeUludGVncmF0aW9uU291cmNlcykge1xuICAgIHZhciBfYSwgX2I7XG4gICAgaWYgKGdsb2JhbEludGVncmF0aW9ucyA9PT0gdm9pZCAwKSB7IGdsb2JhbEludGVncmF0aW9ucyA9IHt9OyB9XG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICBpZiAoaXNTZXJ2ZXIoKSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGlmIChzZXR0aW5ncy5wbGFuKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHZvaWQgMCA/IG9wdGlvbnMgOiB7fTtcbiAgICAgICAgb3B0aW9ucy5wbGFuID0gc2V0dGluZ3MucGxhbjtcbiAgICB9XG4gICAgdmFyIHJvdXRpbmdSdWxlcyA9IChfYiA9IChfYSA9IHNldHRpbmdzLm1pZGRsZXdhcmVTZXR0aW5ncykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJvdXRpbmdSdWxlcykgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogW107XG4gICAgdmFyIHJlbW90ZUludGVncmF0aW9uc0NvbmZpZyA9IHNldHRpbmdzLmludGVncmF0aW9ucztcbiAgICB2YXIgbG9jYWxJbnRlZ3JhdGlvbnNDb25maWcgPSBvcHRpb25zLmludGVncmF0aW9ucztcbiAgICAvLyBtZXJnZWQgcmVtb3RlIENETiBzZXR0aW5ncyB3aXRoIHVzZXIgcHJvdmlkZWQgb3B0aW9uc1xuICAgIHZhciBpbnRlZ3JhdGlvbk9wdGlvbnMgPSBtZXJnZWRPcHRpb25zKHNldHRpbmdzLCBvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHZvaWQgMCA/IG9wdGlvbnMgOiB7fSk7XG4gICAgdmFyIGFkaG9jSW50ZWdyYXRpb25Tb3VyY2VzID0gbGVnYWN5SW50ZWdyYXRpb25Tb3VyY2VzID09PSBudWxsIHx8IGxlZ2FjeUludGVncmF0aW9uU291cmNlcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogbGVnYWN5SW50ZWdyYXRpb25Tb3VyY2VzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBpbnRlZ3JhdGlvblNvdXJjZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX19hc3NpZ24oX19hc3NpZ24oe30sIGFjYyksIChfYSA9IHt9LCBfYVtyZXNvbHZlSW50ZWdyYXRpb25OYW1lRnJvbVNvdXJjZShpbnRlZ3JhdGlvblNvdXJjZSldID0gaW50ZWdyYXRpb25Tb3VyY2UsIF9hKSkpO1xuICAgIH0sIHt9KTtcbiAgICB2YXIgaW5zdGFsbGFibGVJbnRlZ3JhdGlvbnMgPSBuZXcgU2V0KF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgT2JqZWN0LmtleXMocmVtb3RlSW50ZWdyYXRpb25zQ29uZmlnKS5maWx0ZXIoZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGlzSW5zdGFsbGFibGVJbnRlZ3JhdGlvbihuYW1lLCByZW1vdGVJbnRlZ3JhdGlvbnNDb25maWdbbmFtZV0pO1xuICAgIH0pLCB0cnVlKSwgT2JqZWN0LmtleXMoYWRob2NJbnRlZ3JhdGlvblNvdXJjZXMgfHwge30pLmZpbHRlcihmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gaXNQbGFpbk9iamVjdChyZW1vdGVJbnRlZ3JhdGlvbnNDb25maWdbbmFtZV0pIHx8XG4gICAgICAgICAgICBpc1BsYWluT2JqZWN0KGxvY2FsSW50ZWdyYXRpb25zQ29uZmlnID09PSBudWxsIHx8IGxvY2FsSW50ZWdyYXRpb25zQ29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsb2NhbEludGVncmF0aW9uc0NvbmZpZ1tuYW1lXSk7XG4gICAgfSksIHRydWUpKTtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShpbnN0YWxsYWJsZUludGVncmF0aW9ucylcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gIXNob3VsZFNraXBJbnRlZ3JhdGlvbihuYW1lLCBnbG9iYWxJbnRlZ3JhdGlvbnMpOyB9KVxuICAgICAgICAubWFwKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBpbnRlZ3JhdGlvblNldHRpbmdzID0gcmVtb3RlSW50ZWdyYXRpb25zQ29uZmlnW25hbWVdO1xuICAgICAgICB2YXIgdmVyc2lvbiA9IHJlc29sdmVWZXJzaW9uKGludGVncmF0aW9uU2V0dGluZ3MpO1xuICAgICAgICB2YXIgZGVzdGluYXRpb24gPSBuZXcgTGVnYWN5RGVzdGluYXRpb24obmFtZSwgdmVyc2lvbiwgd3JpdGVLZXksIGludGVncmF0aW9uT3B0aW9uc1tuYW1lXSwgb3B0aW9ucywgYWRob2NJbnRlZ3JhdGlvblNvdXJjZXMgPT09IG51bGwgfHwgYWRob2NJbnRlZ3JhdGlvblNvdXJjZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFkaG9jSW50ZWdyYXRpb25Tb3VyY2VzW25hbWVdKTtcbiAgICAgICAgdmFyIHJvdXRpbmcgPSByb3V0aW5nUnVsZXMuZmlsdGVyKGZ1bmN0aW9uIChydWxlKSB7IHJldHVybiBydWxlLmRlc3RpbmF0aW9uTmFtZSA9PT0gbmFtZTsgfSk7XG4gICAgICAgIGlmIChyb3V0aW5nLmxlbmd0aCA+IDAgJiYgcm91dGluZ01pZGRsZXdhcmUpIHtcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uLmFkZE1pZGRsZXdhcmUocm91dGluZ01pZGRsZXdhcmUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXN0aW5hdGlvbjtcbiAgICB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/index.js\n"));

/***/ }),

/***/ "./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/loader.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/loader.js ***!
  \*****************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildIntegration: function() { return /* binding */ buildIntegration; },\n/* harmony export */   loadIntegration: function() { return /* binding */ loadIntegration; },\n/* harmony export */   resolveIntegrationNameFromSource: function() { return /* binding */ resolveIntegrationNameFromSource; },\n/* harmony export */   resolveVersion: function() { return /* binding */ resolveVersion; },\n/* harmony export */   unloadIntegration: function() { return /* binding */ unloadIntegration; }\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _lib_parse_cdn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/parse-cdn */ \"./node_modules/@segment/analytics-next/dist/pkg/lib/parse-cdn.js\");\n/* harmony import */ var _lib_load_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/load-script */ \"./node_modules/@segment/analytics-next/dist/pkg/lib/load-script.js\");\n\n\n\nfunction normalizeName(name) {\n    return name.toLowerCase().replace('.', '').replace(/\\s+/g, '-');\n}\nfunction obfuscatePathName(pathName, obfuscate) {\n    if (obfuscate === void 0) { obfuscate = false; }\n    return obfuscate ? btoa(pathName).replace(/=/g, '') : undefined;\n}\nfunction resolveIntegrationNameFromSource(integrationSource) {\n    return ('Integration' in integrationSource\n        ? integrationSource.Integration\n        : integrationSource).prototype.name;\n}\nfunction recordLoadMetrics(fullPath, ctx, name) {\n    var _a, _b;\n    try {\n        var metric = ((_b = (_a = window === null || window === void 0 ? void 0 : window.performance) === null || _a === void 0 ? void 0 : _a.getEntriesByName(fullPath, 'resource')) !== null && _b !== void 0 ? _b : [])[0];\n        // we assume everything that took under 100ms is cached\n        metric &&\n            ctx.stats.gauge('legacy_destination_time', Math.round(metric.duration), (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([\n                name\n            ], (metric.duration < 100 ? ['cached'] : []), true));\n    }\n    catch (_) {\n        // not available\n    }\n}\nfunction buildIntegration(integrationSource, integrationSettings, analyticsInstance) {\n    var integrationCtr;\n    // GA and Appcues use a different interface to instantiating integrations\n    if ('Integration' in integrationSource) {\n        var analyticsStub = {\n            user: function () { return analyticsInstance.user(); },\n            addIntegration: function () { },\n        };\n        integrationSource(analyticsStub);\n        integrationCtr = integrationSource.Integration;\n    }\n    else {\n        integrationCtr = integrationSource;\n    }\n    var integration = new integrationCtr(integrationSettings);\n    integration.analytics = analyticsInstance;\n    return integration;\n}\nfunction loadIntegration(ctx, name, version, obfuscate) {\n    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n        var pathName, obfuscatedPathName, path, fullPath, err_1, deps;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    pathName = normalizeName(name);\n                    obfuscatedPathName = obfuscatePathName(pathName, obfuscate);\n                    path = (0,_lib_parse_cdn__WEBPACK_IMPORTED_MODULE_1__.getNextIntegrationsURL)();\n                    fullPath = \"\".concat(path, \"/integrations/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \"/\").concat(version, \"/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \".dynamic.js.gz\");\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, (0,_lib_load_script__WEBPACK_IMPORTED_MODULE_2__.loadScript)(fullPath)];\n                case 2:\n                    _a.sent();\n                    recordLoadMetrics(fullPath, ctx, name);\n                    return [3 /*break*/, 4];\n                case 3:\n                    err_1 = _a.sent();\n                    ctx.stats.gauge('legacy_destination_time', -1, [\"plugin:\".concat(name), \"failed\"]);\n                    throw err_1;\n                case 4:\n                    deps = window[\"\".concat(pathName, \"Deps\")];\n                    return [4 /*yield*/, Promise.all(deps.map(function (dep) { return (0,_lib_load_script__WEBPACK_IMPORTED_MODULE_2__.loadScript)(path + dep + '.gz'); }))\n                        // @ts-ignore\n                    ];\n                case 5:\n                    _a.sent();\n                    // @ts-ignore\n                    window[\"\".concat(pathName, \"Loader\")]();\n                    return [2 /*return*/, window[\n                        // @ts-ignore\n                        \"\".concat(pathName, \"Integration\")]];\n            }\n        });\n    });\n}\nfunction unloadIntegration(name, version, obfuscate) {\n    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {\n        var path, pathName, obfuscatedPathName, fullPath;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {\n            path = (0,_lib_parse_cdn__WEBPACK_IMPORTED_MODULE_1__.getNextIntegrationsURL)();\n            pathName = normalizeName(name);\n            obfuscatedPathName = obfuscatePathName(name, obfuscate);\n            fullPath = \"\".concat(path, \"/integrations/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \"/\").concat(version, \"/\").concat(obfuscatedPathName !== null && obfuscatedPathName !== void 0 ? obfuscatedPathName : pathName, \".dynamic.js.gz\");\n            return [2 /*return*/, (0,_lib_load_script__WEBPACK_IMPORTED_MODULE_2__.unloadScript)(fullPath)];\n        });\n    });\n}\nfunction resolveVersion(settings) {\n    var _a, _b, _c, _d;\n    return ((_d = (_b = (_a = settings === null || settings === void 0 ? void 0 : settings.versionSettings) === null || _a === void 0 ? void 0 : _a.override) !== null && _b !== void 0 ? _b : (_c = settings === null || settings === void 0 ? void 0 : settings.versionSettings) === null || _c === void 0 ? void 0 : _c.version) !== null && _d !== void 0 ? _d : 'latest');\n}\n//# sourceMappingURL=loader.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5leHQvZGlzdC9wa2cvcGx1Z2lucy9hanMtZGVzdGluYXRpb24vbG9hZGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQThEO0FBQ0Q7QUFDSTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9GQUFvRixvREFBYTtBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msa0NBQWtDO0FBQ2xFLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxXQUFXLGdEQUFTO0FBQ3BCO0FBQ0EsZUFBZSxrREFBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzRUFBc0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsNERBQVU7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRUFBK0UsT0FBTyw0REFBVSx1QkFBdUI7QUFDdkg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ087QUFDUCxXQUFXLGdEQUFTO0FBQ3BCO0FBQ0EsZUFBZSxrREFBVztBQUMxQixtQkFBbUIsc0VBQXNCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyw4REFBWTtBQUM5QyxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5leHQvZGlzdC9wa2cvcGx1Z2lucy9hanMtZGVzdGluYXRpb24vbG9hZGVyLmpzPzFjODYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgX19hd2FpdGVyLCBfX2dlbmVyYXRvciwgX19zcHJlYWRBcnJheSB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgZ2V0TmV4dEludGVncmF0aW9uc1VSTCB9IGZyb20gJy4uLy4uL2xpYi9wYXJzZS1jZG4nO1xuaW1wb3J0IHsgbG9hZFNjcmlwdCwgdW5sb2FkU2NyaXB0IH0gZnJvbSAnLi4vLi4vbGliL2xvYWQtc2NyaXB0JztcbmZ1bmN0aW9uIG5vcm1hbGl6ZU5hbWUobmFtZSkge1xuICAgIHJldHVybiBuYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgnLicsICcnKS5yZXBsYWNlKC9cXHMrL2csICctJyk7XG59XG5mdW5jdGlvbiBvYmZ1c2NhdGVQYXRoTmFtZShwYXRoTmFtZSwgb2JmdXNjYXRlKSB7XG4gICAgaWYgKG9iZnVzY2F0ZSA9PT0gdm9pZCAwKSB7IG9iZnVzY2F0ZSA9IGZhbHNlOyB9XG4gICAgcmV0dXJuIG9iZnVzY2F0ZSA/IGJ0b2EocGF0aE5hbWUpLnJlcGxhY2UoLz0vZywgJycpIDogdW5kZWZpbmVkO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVJbnRlZ3JhdGlvbk5hbWVGcm9tU291cmNlKGludGVncmF0aW9uU291cmNlKSB7XG4gICAgcmV0dXJuICgnSW50ZWdyYXRpb24nIGluIGludGVncmF0aW9uU291cmNlXG4gICAgICAgID8gaW50ZWdyYXRpb25Tb3VyY2UuSW50ZWdyYXRpb25cbiAgICAgICAgOiBpbnRlZ3JhdGlvblNvdXJjZSkucHJvdG90eXBlLm5hbWU7XG59XG5mdW5jdGlvbiByZWNvcmRMb2FkTWV0cmljcyhmdWxsUGF0aCwgY3R4LCBuYW1lKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICB0cnkge1xuICAgICAgICB2YXIgbWV0cmljID0gKChfYiA9IChfYSA9IHdpbmRvdyA9PT0gbnVsbCB8fCB3aW5kb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdpbmRvdy5wZXJmb3JtYW5jZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmdldEVudHJpZXNCeU5hbWUoZnVsbFBhdGgsICdyZXNvdXJjZScpKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBbXSlbMF07XG4gICAgICAgIC8vIHdlIGFzc3VtZSBldmVyeXRoaW5nIHRoYXQgdG9vayB1bmRlciAxMDBtcyBpcyBjYWNoZWRcbiAgICAgICAgbWV0cmljICYmXG4gICAgICAgICAgICBjdHguc3RhdHMuZ2F1Z2UoJ2xlZ2FjeV9kZXN0aW5hdGlvbl90aW1lJywgTWF0aC5yb3VuZChtZXRyaWMuZHVyYXRpb24pLCBfX3NwcmVhZEFycmF5KFtcbiAgICAgICAgICAgICAgICBuYW1lXG4gICAgICAgICAgICBdLCAobWV0cmljLmR1cmF0aW9uIDwgMTAwID8gWydjYWNoZWQnXSA6IFtdKSwgdHJ1ZSkpO1xuICAgIH1cbiAgICBjYXRjaCAoXykge1xuICAgICAgICAvLyBub3QgYXZhaWxhYmxlXG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkSW50ZWdyYXRpb24oaW50ZWdyYXRpb25Tb3VyY2UsIGludGVncmF0aW9uU2V0dGluZ3MsIGFuYWx5dGljc0luc3RhbmNlKSB7XG4gICAgdmFyIGludGVncmF0aW9uQ3RyO1xuICAgIC8vIEdBIGFuZCBBcHBjdWVzIHVzZSBhIGRpZmZlcmVudCBpbnRlcmZhY2UgdG8gaW5zdGFudGlhdGluZyBpbnRlZ3JhdGlvbnNcbiAgICBpZiAoJ0ludGVncmF0aW9uJyBpbiBpbnRlZ3JhdGlvblNvdXJjZSkge1xuICAgICAgICB2YXIgYW5hbHl0aWNzU3R1YiA9IHtcbiAgICAgICAgICAgIHVzZXI6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGFuYWx5dGljc0luc3RhbmNlLnVzZXIoKTsgfSxcbiAgICAgICAgICAgIGFkZEludGVncmF0aW9uOiBmdW5jdGlvbiAoKSB7IH0sXG4gICAgICAgIH07XG4gICAgICAgIGludGVncmF0aW9uU291cmNlKGFuYWx5dGljc1N0dWIpO1xuICAgICAgICBpbnRlZ3JhdGlvbkN0ciA9IGludGVncmF0aW9uU291cmNlLkludGVncmF0aW9uO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW50ZWdyYXRpb25DdHIgPSBpbnRlZ3JhdGlvblNvdXJjZTtcbiAgICB9XG4gICAgdmFyIGludGVncmF0aW9uID0gbmV3IGludGVncmF0aW9uQ3RyKGludGVncmF0aW9uU2V0dGluZ3MpO1xuICAgIGludGVncmF0aW9uLmFuYWx5dGljcyA9IGFuYWx5dGljc0luc3RhbmNlO1xuICAgIHJldHVybiBpbnRlZ3JhdGlvbjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBsb2FkSW50ZWdyYXRpb24oY3R4LCBuYW1lLCB2ZXJzaW9uLCBvYmZ1c2NhdGUpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXRoTmFtZSwgb2JmdXNjYXRlZFBhdGhOYW1lLCBwYXRoLCBmdWxsUGF0aCwgZXJyXzEsIGRlcHM7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhOYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgb2JmdXNjYXRlZFBhdGhOYW1lID0gb2JmdXNjYXRlUGF0aE5hbWUocGF0aE5hbWUsIG9iZnVzY2F0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHBhdGggPSBnZXROZXh0SW50ZWdyYXRpb25zVVJMKCk7XG4gICAgICAgICAgICAgICAgICAgIGZ1bGxQYXRoID0gXCJcIi5jb25jYXQocGF0aCwgXCIvaW50ZWdyYXRpb25zL1wiKS5jb25jYXQob2JmdXNjYXRlZFBhdGhOYW1lICE9PSBudWxsICYmIG9iZnVzY2F0ZWRQYXRoTmFtZSAhPT0gdm9pZCAwID8gb2JmdXNjYXRlZFBhdGhOYW1lIDogcGF0aE5hbWUsIFwiL1wiKS5jb25jYXQodmVyc2lvbiwgXCIvXCIpLmNvbmNhdChvYmZ1c2NhdGVkUGF0aE5hbWUgIT09IG51bGwgJiYgb2JmdXNjYXRlZFBhdGhOYW1lICE9PSB2b2lkIDAgPyBvYmZ1c2NhdGVkUGF0aE5hbWUgOiBwYXRoTmFtZSwgXCIuZHluYW1pYy5qcy5nelwiKTtcbiAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgbG9hZFNjcmlwdChmdWxsUGF0aCldO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICByZWNvcmRMb2FkTWV0cmljcyhmdWxsUGF0aCwgY3R4LCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LnN0YXRzLmdhdWdlKCdsZWdhY3lfZGVzdGluYXRpb25fdGltZScsIC0xLCBbXCJwbHVnaW46XCIuY29uY2F0KG5hbWUpLCBcImZhaWxlZFwiXSk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycl8xO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgZGVwcyA9IHdpbmRvd1tcIlwiLmNvbmNhdChwYXRoTmFtZSwgXCJEZXBzXCIpXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwoZGVwcy5tYXAoZnVuY3Rpb24gKGRlcCkgeyByZXR1cm4gbG9hZFNjcmlwdChwYXRoICsgZGVwICsgJy5neicpOyB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dbXCJcIi5jb25jYXQocGF0aE5hbWUsIFwiTG9hZGVyXCIpXSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgd2luZG93W1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgXCJcIi5jb25jYXQocGF0aE5hbWUsIFwiSW50ZWdyYXRpb25cIildXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gdW5sb2FkSW50ZWdyYXRpb24obmFtZSwgdmVyc2lvbiwgb2JmdXNjYXRlKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGF0aCwgcGF0aE5hbWUsIG9iZnVzY2F0ZWRQYXRoTmFtZSwgZnVsbFBhdGg7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHBhdGggPSBnZXROZXh0SW50ZWdyYXRpb25zVVJMKCk7XG4gICAgICAgICAgICBwYXRoTmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICBvYmZ1c2NhdGVkUGF0aE5hbWUgPSBvYmZ1c2NhdGVQYXRoTmFtZShuYW1lLCBvYmZ1c2NhdGUpO1xuICAgICAgICAgICAgZnVsbFBhdGggPSBcIlwiLmNvbmNhdChwYXRoLCBcIi9pbnRlZ3JhdGlvbnMvXCIpLmNvbmNhdChvYmZ1c2NhdGVkUGF0aE5hbWUgIT09IG51bGwgJiYgb2JmdXNjYXRlZFBhdGhOYW1lICE9PSB2b2lkIDAgPyBvYmZ1c2NhdGVkUGF0aE5hbWUgOiBwYXRoTmFtZSwgXCIvXCIpLmNvbmNhdCh2ZXJzaW9uLCBcIi9cIikuY29uY2F0KG9iZnVzY2F0ZWRQYXRoTmFtZSAhPT0gbnVsbCAmJiBvYmZ1c2NhdGVkUGF0aE5hbWUgIT09IHZvaWQgMCA/IG9iZnVzY2F0ZWRQYXRoTmFtZSA6IHBhdGhOYW1lLCBcIi5keW5hbWljLmpzLmd6XCIpO1xuICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHVubG9hZFNjcmlwdChmdWxsUGF0aCldO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlVmVyc2lvbihzZXR0aW5ncykge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcbiAgICByZXR1cm4gKChfZCA9IChfYiA9IChfYSA9IHNldHRpbmdzID09PSBudWxsIHx8IHNldHRpbmdzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZXR0aW5ncy52ZXJzaW9uU2V0dGluZ3MpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5vdmVycmlkZSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogKF9jID0gc2V0dGluZ3MgPT09IG51bGwgfHwgc2V0dGluZ3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNldHRpbmdzLnZlcnNpb25TZXR0aW5ncykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnZlcnNpb24pICE9PSBudWxsICYmIF9kICE9PSB2b2lkIDAgPyBfZCA6ICdsYXRlc3QnKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvYWRlci5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/loader.js\n"));

/***/ }),

/***/ "./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/utils.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/utils.js ***!
  \****************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isDisabledIntegration: function() { return /* binding */ isDisabledIntegration; },\n/* harmony export */   isInstallableIntegration: function() { return /* binding */ isInstallableIntegration; }\n/* harmony export */ });\nvar isInstallableIntegration = function (name, integrationSettings) {\n    var _a;\n    var type = integrationSettings.type, bundlingStatus = integrationSettings.bundlingStatus, versionSettings = integrationSettings.versionSettings;\n    // We use `!== 'unbundled'` (versus `=== 'bundled'`) to be inclusive of\n    // destinations without a defined value for `bundlingStatus`\n    var deviceMode = bundlingStatus !== 'unbundled' &&\n        (type === 'browser' || ((_a = versionSettings === null || versionSettings === void 0 ? void 0 : versionSettings.componentTypes) === null || _a === void 0 ? void 0 : _a.includes('browser')));\n    // checking for iterable is a quick fix we need in place to prevent\n    // errors showing Iterable as a failed destiantion. Ideally, we should\n    // fix the Iterable metadata instead, but that's a longer process.\n    return !name.startsWith('Segment') && name !== 'Iterable' && deviceMode;\n};\nvar isDisabledIntegration = function (integrationName, globalIntegrations) {\n    var allDisableAndNotDefined = globalIntegrations.All === false &&\n        globalIntegrations[integrationName] === undefined;\n    return (globalIntegrations[integrationName] === false || allDisableAndNotDefined);\n};\n//# sourceMappingURL=utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHNlZ21lbnQvYW5hbHl0aWNzLW5leHQvZGlzdC9wa2cvcGx1Z2lucy9hanMtZGVzdGluYXRpb24vdXRpbHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BzZWdtZW50L2FuYWx5dGljcy1uZXh0L2Rpc3QvcGtnL3BsdWdpbnMvYWpzLWRlc3RpbmF0aW9uL3V0aWxzLmpzPzZkMTQiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHZhciBpc0luc3RhbGxhYmxlSW50ZWdyYXRpb24gPSBmdW5jdGlvbiAobmFtZSwgaW50ZWdyYXRpb25TZXR0aW5ncykge1xuICAgIHZhciBfYTtcbiAgICB2YXIgdHlwZSA9IGludGVncmF0aW9uU2V0dGluZ3MudHlwZSwgYnVuZGxpbmdTdGF0dXMgPSBpbnRlZ3JhdGlvblNldHRpbmdzLmJ1bmRsaW5nU3RhdHVzLCB2ZXJzaW9uU2V0dGluZ3MgPSBpbnRlZ3JhdGlvblNldHRpbmdzLnZlcnNpb25TZXR0aW5ncztcbiAgICAvLyBXZSB1c2UgYCE9PSAndW5idW5kbGVkJ2AgKHZlcnN1cyBgPT09ICdidW5kbGVkJ2ApIHRvIGJlIGluY2x1c2l2ZSBvZlxuICAgIC8vIGRlc3RpbmF0aW9ucyB3aXRob3V0IGEgZGVmaW5lZCB2YWx1ZSBmb3IgYGJ1bmRsaW5nU3RhdHVzYFxuICAgIHZhciBkZXZpY2VNb2RlID0gYnVuZGxpbmdTdGF0dXMgIT09ICd1bmJ1bmRsZWQnICYmXG4gICAgICAgICh0eXBlID09PSAnYnJvd3NlcicgfHwgKChfYSA9IHZlcnNpb25TZXR0aW5ncyA9PT0gbnVsbCB8fCB2ZXJzaW9uU2V0dGluZ3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZlcnNpb25TZXR0aW5ncy5jb21wb25lbnRUeXBlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKCdicm93c2VyJykpKTtcbiAgICAvLyBjaGVja2luZyBmb3IgaXRlcmFibGUgaXMgYSBxdWljayBmaXggd2UgbmVlZCBpbiBwbGFjZSB0byBwcmV2ZW50XG4gICAgLy8gZXJyb3JzIHNob3dpbmcgSXRlcmFibGUgYXMgYSBmYWlsZWQgZGVzdGlhbnRpb24uIElkZWFsbHksIHdlIHNob3VsZFxuICAgIC8vIGZpeCB0aGUgSXRlcmFibGUgbWV0YWRhdGEgaW5zdGVhZCwgYnV0IHRoYXQncyBhIGxvbmdlciBwcm9jZXNzLlxuICAgIHJldHVybiAhbmFtZS5zdGFydHNXaXRoKCdTZWdtZW50JykgJiYgbmFtZSAhPT0gJ0l0ZXJhYmxlJyAmJiBkZXZpY2VNb2RlO1xufTtcbmV4cG9ydCB2YXIgaXNEaXNhYmxlZEludGVncmF0aW9uID0gZnVuY3Rpb24gKGludGVncmF0aW9uTmFtZSwgZ2xvYmFsSW50ZWdyYXRpb25zKSB7XG4gICAgdmFyIGFsbERpc2FibGVBbmROb3REZWZpbmVkID0gZ2xvYmFsSW50ZWdyYXRpb25zLkFsbCA9PT0gZmFsc2UgJiZcbiAgICAgICAgZ2xvYmFsSW50ZWdyYXRpb25zW2ludGVncmF0aW9uTmFtZV0gPT09IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gKGdsb2JhbEludGVncmF0aW9uc1tpbnRlZ3JhdGlvbk5hbWVdID09PSBmYWxzZSB8fCBhbGxEaXNhYmxlQW5kTm90RGVmaW5lZCk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@segment/analytics-next/dist/pkg/plugins/ajs-destination/utils.js\n"));

/***/ })

}]);